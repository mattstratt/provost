<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <title>Upcoming Provost Events</title>
  <style>
    h1 {
      font-family: 'Proxima Nova', sans-serif;
      font-size: 14px;
      text-align: center;
      color: #006eb3;
    }
    h3.event-date {
      font-family: 'Proxima Nova', sans-serif;
      color: #006eb3;
      font-weight: bold;
      font-size: 12px;
    }

    p {
      font-family: 'Proxima Nova', sans-serif;
      color: black;
      margin: 0.2em 0;
      font-size: 10px;
    }
    p.event-info {
      font-weight: bold;
      font-size: 12px;
    }
    span.event-location {
      font-weight: normal;
      font-size: 12px;
    }
    a.event-link {
      font-style: italic;
      color: blue;
      font-size: 12px;
    }
    p.event-for,
    p.event-location {
      font-weight: bold;
    }
    b {
      font-weight: bold;
    }
  </style>
  <script src="https://apis.google.com/js/api.js"></script>
</head>
<body>

  <h1>Engaging Activities for Students and Employees</h1>
  <p style="font-family: 'Proxima Nova', sans-serif; color: black; font-size: 12px; text-align: center;">
    Please participate and help us spread the word!
  </p>
  
  <!-- Month and Year Dropdown -->
  <div style="text-align: center; margin-bottom: 10px;">
    <label>Select Month: </label>
    <select id="monthDropdown">
      <option value="0">January</option>
      <option value="1">February</option>
      <option value="2">March</option>
      <option value="3">April</option>
      <option value="4">May</option>
      <option value="5">June</option>
      <option value="6">July</option>
      <option value="7">August</option>
      <option value="8">September</option>
      <option value="9">October</option>
      <option value="10">November</option>
      <option value="11">December</option>
    </select>

    <label>Select Year: </label>
    <select id="yearDropdown">
      <option value="2022">2022</option>
      <option value="2023">2023</option>
      <!-- ... (you can add more years if needed) ... -->
    </select>

    <button onclick="listUpcomingEvents()">Show Events</button>
  </div>
  
  <br>
  <div id="events-list">
    <!-- Events will be populated here -->
  </div>

  <script>
    function formatTime(dateObj) {
      var hours = dateObj.getHours();
      var minutes = dateObj.getMinutes();
      var ampm = hours >= 12 ? 'PM' : 'AM';
      hours = hours % 12;
      hours = hours ? hours : 12;
      return (hours < 10 ? '0' : '') + hours + ':' + (minutes < 10 ? '0' : '') + minutes + ' ' + ampm;
    }

    function listUpcomingEvents() {
      var monthDropdown = document.getElementById("monthDropdown");
      var yearDropdown = document.getElementById("yearDropdown");
      var selectedMonth = parseInt(monthDropdown.value);
      var selectedYear = parseInt(yearDropdown.value);

      var firstDayOfMonth = new Date(selectedYear, selectedMonth, 1);
      var lastDayOfMonth = new Date(selectedYear, selectedMonth + 1, 0, 23, 59, 59);
      
      // Clear previous events
      document.getElementById('events-list').innerHTML = "";

      // ... (rest of the code to fetch events based on the selected month and year) ...
    }

    function initClient() {
      gapi.client.init({
        'apiKey': 'AIzaSyAecA9n1YO3WPakqJ9ogmSni0GnseQtvTg',
        'discoveryDocs': ["https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest"],
      }).then(function () {
        gapi.client.load('calendar', 'v3', listUpcomingEvents);
      });
    }

    function handleClientLoad() {
      gapi.load('client', initClient);
    }
  </script>

  <!-- Google API script -->
  <script async defer src="https://apis.google.com/js/api.js"
  onload="handleClientLoad()" onreadystatechange="if (this.readyState === 'complete') handleClientLoad()">
  </script>

</body>
</html>
