<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Upcoming Events</title>
  <script src="https://apis.google.com/js/api.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Proxima+Nova:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body, h3, p {
      font-family: 'Proxima Nova', sans-serif;
    }
    h3 {
      font-weight: bold;
      color: #006eb3;
    }
    p.event-name {
      font-weight: bold;
      font-style: italic;
    }
    p.event-time, p.event-description, p.event-location {
      font-style: italic;
    }
    .event-container {
      margin-bottom: 20px;
    }
  </style>
</head>
<body>

  <h1>Upcoming Events</h1>
  <div id="events-list">
    <!-- Events will be populated here -->
  </div>

  <script>
    function listUpcomingEvents() {
      gapi.client.calendar.events.list({
        'calendarId': '9d473971a24aa2563d5c86101bd0e5f2aa02b76e73846c97c7d967b2fc46a8e5@group.calendar.google.com',
        'timeMin': (new Date()).toISOString(),
        'showDeleted': false,
        'singleEvents': true,
        'maxResults': 10,
        'orderBy': 'startTime'
      }).then(function(response) {
        var events = response.result.items;
        var eventsList = document.getElementById('events-list');

        if (events.length > 0) {
          for (var i = 0; i < events.length; i++) {
            var event = events[i];
            var when = new Date(event.start.dateTime || event.start.date);
            var options = { year: 'numeric', month: 'long', day: 'numeric' };
            var formattedDate = when.toLocaleDateString('en-US', options);

            var eventDiv = document.createElement('div');
            eventDiv.className = 'event-container';

            var dateElement = document.createElement('h3');
            dateElement.textContent = formattedDate;
            
            var nameElement = document.createElement('p');
            nameElement.className = 'event-name';
            nameElement.textContent = event.summary;
            
            var timeElement = document.createElement('p');
            timeElement.className = 'event-time';
            timeElement.textContent = when.getHours() + ':' + when.getMinutes();

            var descElement = document.createElement('p');
            descElement.className = 'event-description';
            descElement.textContent = event.description || 'No description available';
            
            eventDiv.appendChild(dateElement);
            eventDiv.appendChild(nameElement);
            eventDiv.appendChild(timeElement);
            eventDiv.appendChild(descElement);
            eventsList.appendChild(eventDiv);
          }
        } else {
          var listItem = document.createElement('div');
          listItem.textContent = 'No upcoming events found.';
          eventsList.appendChild(listItem);
        }
      });
    }

    function initClient() {
      gapi.client.init({
        'apiKey': 'AIzaSyAecA9n1YO3WPakqJ9ogmSni0GnseQtvTg',
        'discoveryDocs': ["https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest"],
      }).then(function () {
        listUpcomingEvents();
      });
    }

    function handleClientLoad() {
      gapi.load('client', initClient);
    }
  </script>

  <script async defer src="https://apis.google.com/js/api.js"
    onload="handleClientLoad()" onreadystatechange="if (this.readyState === 'complete') handleClientLoad()">
  </script>

</body>
</html>
