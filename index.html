<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Upcoming Provost Events</title>
  <link href="https://fonts.googleapis.com/css2?family=Proxima+Nova:wght@400;700&display=swap" rel="stylesheet">
  <script src="https://apis.google.com/js/api.js"></script>
  <style>
    body, h3, p {
      font-family: 'Proxima Nova', sans-serif;
    }
    h3.event-date {
      font-weight: bold;
      color: #006eb3;
    }
    p.event-name {
      font-weight: bold;
      font-style: italic;
    }
    p.event-time, p.event-description, p.event-location, a.event-location {
      font-style: italic;
    }
    .event-container {
      margin-bottom: 20px;
    }
  </style>
</head>
<body>

  <h1>Upcoming Events</h1>
  <div id="events-list">
    <!-- Events will be populated here -->
  </div>

  <script>
    function addEventsToList() {
      var sheet = SpreadsheetApp.getActiveSheet();
      var rows = sheet.getRange('A2:H' + sheet.getLastRow()).getValues();
      
      var eventsList = document.getElementById('events-list');

      for (var i = 0; i < rows.length; i++) {
        var row = rows[i];

        // Create an individual event container
        var eventDiv = document.createElement('div');
        eventDiv.className = 'event-container';

        // Date
        var eventDate = new Date(row[2]);
        var options = { year: 'numeric', month: 'long', day: 'numeric' };
        var formattedDate = eventDate.toLocaleDateString('en-US', options);
        var dateElement = document.createElement('h3');
        dateElement.className = 'event-date';
        dateElement.textContent = formattedDate;

        // Event name
        var eventName = row[1];
        var nameElement = document.createElement('p');
        nameElement.className = 'event-name';
        nameElement.textContent = eventName;

        // Event time
        var startTime = new Date(row[3]);
        var endTime = new Date(row[7]);
        var timeElement = document.createElement('p');
        timeElement.className = 'event-time';
        timeElement.textContent = startTime.getHours() + ':' + startTime.getMinutes() + ' - ' + endTime.getHours() + ':' + endTime.getMinutes();

        // Event description
        var eventDescription = row[5];
        var descElement = document.createElement('p');
        descElement.className = 'event-description';
        descElement.textContent = eventDescription;

        // Event location
        var eventLocation = row[4];
        var locationElement;
        if (eventLocation.startsWith('http')) {
          locationElement = document.createElement('a');
          locationElement.className = 'event-location';
          locationElement.href = eventLocation;
          locationElement.textContent = 'Location Link';
        } else {
          locationElement = document.createElement('p');
          locationElement.className = 'event-location';
          locationElement.textContent = eventLocation;
        }

        // Append everything to the event container
        eventDiv.appendChild(dateElement);
        eventDiv.appendChild(nameElement);
        eventDiv.appendChild(timeElement);
        eventDiv.appendChild(descElement);
        eventDiv.appendChild(locationElement);

        // Append the event container to the events list
        eventsList.appendChild(eventDiv);
      }
    }

    // Call the function to populate the list
    addEventsToList();
  </script>

</body>
</html>
