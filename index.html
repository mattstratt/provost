<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <title>Upcoming Provost Events</title>
  <style>
    /* ... (Your provided styles) ... */
  </style>
  <script src="https://apis.google.com/js/api.js"></script>
</head>
<body>

<h1>Engaging Activities for Students and Employees</h1>
<p style="font-family: 'Proxima Nova', sans-serif; color: black; font-size: 12px; text-align: center;">
    Please participate and help us spread the word!
</p>

<!-- Month and Year Dropdown -->
<div style="text-align: center; margin-bottom: 10px;">
    <label>Select Month: </label>
    <select id="monthDropdown">
        <option value="0">January</option>
        <option value="1">February</option>
        <option value="2">March</option>
        <option value="3">April</option>
        <option value="4">May</option>
        <option value="5">June</option>
        <option value="6">July</option>
        <option value="7">August</option>
        <option value="8">September</option>
        <option value="9">October</option>
        <option value="10">November</option>
        <option value="11">December</option>
    </select>

    <label>Select Year: </label>
    <select id="yearDropdown">
        <option value="2022">2022</option>
        <option value="2023">2023</option>
        <!-- ... (You can add more years if needed) ... -->
    </select>

    <button onclick="listUpcomingEvents()">Show Events</button>
</div>

<br>
<div id="events-list">
    <!-- Events will be populated here -->
</div>

<script>
    function formatTime(dateObj) {
        /* ... (Your provided formatTime function) ... */
    }

    function listUpcomingEvents() {
        var monthDropdown = document.getElementById("monthDropdown");
        var yearDropdown = document.getElementById("yearDropdown");
        var selectedMonth = parseInt(monthDropdown.value);
        var selectedYear = parseInt(yearDropdown.value);

        var firstDayOfMonth = new Date(selectedYear, selectedMonth, 1);
        var lastDayOfMonth = new Date(selectedYear, selectedMonth + 1, 0, 23, 59, 59);

        // Clear previous events
        document.getElementById('events-list').innerHTML = "";

        gapi.client.calendar.events.list({
            'calendarId': '9d473971a24aa2563d5c86101bd0e5f2aa02b76e73846c97c7d967b2fc46a8e5@group.calendar.google.com',
            'timeMin': firstDayOfMonth.toISOString(),
            'timeMax': lastDayOfMonth.toISOString(),
            'showDeleted': false,
            'singleEvents': true,
            'maxResults': 10,
            'orderBy': 'startTime'
        }).then(function (response) {
            var events = response.result.items;
            var eventsList = document.getElementById('events-list');

            if (events.length > 0) {
                for (var i = 0; i < events.length; i++) {
                    /* ... (Your provided event processing and display logic) ... */
                }
            } else {
                var noEventsElement = document.createElement('p');
                noEventsElement.textContent = 'No upcoming events found.';
                eventsList.appendChild(noEventsElement);
            }
        });
    }

    function initClient() {
        gapi.client.init({
            'apiKey': 'AIzaSyAecA9n1YO3WPakqJ9ogmSni0GnseQtvTg',
            'discoveryDocs': ["https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest"],
        }).then(function () {
            gapi.client.load('calendar', 'v3', listUpcomingEvents);
        });
    }

    function handleClientLoad() {
        gapi.load('client', initClient);
    }
</script>

<!-- Google API script -->
<script async defer src="https://apis.google.com/js/api.js"
        onload="handleClientLoad()" onreadystatechange="if (this.readyState === 'complete') handleClientLoad()">
</script>

</body>
</html>
